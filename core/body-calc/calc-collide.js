var e=require("../../@babel/runtime/helpers/possibleConstructorReturn"),t=require("../../@babel/runtime/helpers/getPrototypeOf"),r=require("../../@babel/runtime/helpers/inherits"),i=require("../../@babel/runtime/helpers/createClass"),n=require("../../@babel/runtime/helpers/classCallCheck");function o(r,i,n){return i=t(i),e(r,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(i,n||[],t(r).constructor):i.apply(r,n))}var l=require("../../utils/utils"),c=require("../saber"),s=require("./calc-base"),u=i((function e(){n(this,e),this.name="双手触碰检测",this.calc="collide",this.collideX=0,this.collideY=0,this.scope=null,this.points=[]})),a=function(e){function t(){return n(this,t),o(this,t,arguments)}return r(t,s),i(t,[{key:"getDefaultScope",value:function(e){if(l.isEmptyArray(e))return-1;var t=this.findPoint(e,"left_eye"),r=this.findPoint(e,"right_eye");if(!t||!r)return-1;var i=r.x-t.x;return i=Math.abs(i),i/=2,c.writeConsoleDebug("默认碰撞范围".concat(i)),i}},{key:"isCollide",value:function(e,t,r,i,n){if(l.isNone(t))throw new Error("请指定预期碰撞点X坐标");if(l.isNone(r))throw new Error("指定预期碰撞点Y坐标");if(l.isEmptyArray(e))return!1;l.isNone(n)&&(n=this.getDefaultScope(e));var o=this.findPoint(e,i);return!!o&&(!(o.x<t-n||o.x>t+n)&&!(o.y<r-n||o.y>r+n))}},{key:"judging",value:function(e,t){if(!t||"collide"!=t.calc)throw new Error("规则为空，或者配置的不是碰撞检测规则");if(l.isEmptyArray(t.points))throw new Error("请指少在point中指定个待检测的碰撞点key");try{if(!t.collideX||!t.collideY){if(t.points.length<2)throw new Error("不指定预期碰撞点坐标，points内必须指定两个以上的碰撞点");var r=this.findPoint(e.keypoints,t.points[0]);if(!r)return!1;t.points.shift(),t.collideX=r.x,t.collideY=r.y}var i=this;return t.points.every((function(r){return i.isCollide(e.keypoints,t.collideX,t.collideY,r,t.scope)}))}catch(e){console.warn("calc-collide",e)}}}])}();module.exports={CalcRuleCollide:u,CalcCollide:a};