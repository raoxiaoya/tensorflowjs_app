require("../../@babel/runtime/helpers/Arrayincludes");var e=require("../../@babel/runtime/helpers/possibleConstructorReturn"),t=require("../../@babel/runtime/helpers/getPrototypeOf"),r=require("../../@babel/runtime/helpers/inherits"),i=require("../../@babel/runtime/helpers/createClass"),n=require("../../@babel/runtime/helpers/classCallCheck");function o(r,i,n){return i=t(i),e(r,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(i,n||[],t(r).constructor):i.apply(r,n))}var s=require("../../utils/utils"),u=require("../saber"),c=require("./calc-base"),a=i((function e(){n(this,e),this.name="相对位置检测",this.calc="position",this.referenceKey=null,this.positionKey=null,this.position="top",this.scope=null,this.relaxed=!1})),l=function(e){function t(){return n(this,t),o(this,t,arguments)}return r(t,c),i(t,[{key:"getDefaultScope",value:function(e,t){if(s.isEmptyArray(e))return-1;var r=this.findPoint(e,"left_eye",t.relaxed),i=this.findPoint(e,"right_eye",t.relaxed);if(!r||!i)return-1;var n=i.x-r.x;return n=Math.abs(n),u.writeConsoleDebug("默认偏移范围".concat(n)),n}},{key:"judging",value:function(e,t){if(!t||"position"!=t.calc)throw new Error("规则为空，或者配置的不是位置检查规则。");if(!t.referenceKey||!t.positionKey)throw new Error("参考点referenceKey和位置参考点positionKey点不能为空。");if(!t.position)throw new Error("position不能为空。");if(0==["top","bottom","left","right"].includes(t.position))throw new Error("".concat(t.position,"位置无法识别。"));if(!e)return!1;try{var r=this.findPoint(e.keypoints,t.referenceKey,t.relaxed),i=this.findPoint(e.keypoints,t.positionKey,t.relaxed);if(!r||!i)return!1;var n=t.scope||this.getDefaultScope(e.keypoints,t);switch(t.position){case"top":return i.y<r.y&&Math.abs(r.y-i.y)>=n;case"bottom":return i.y>r.y&&Math.abs(r.y-i.y)>=n;case"left":return i.x<r.x&&Math.abs(r.x-i.x)>=n;case"right":return i.x>r.x&&Math.abs(r.x-i.x)>=n}}catch(e){console.error("calc-position",e)}}}])}();module.exports={CalcRulePosition:a,CalcPosition:l};