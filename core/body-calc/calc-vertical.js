var e=require("../../@babel/runtime/helpers/possibleConstructorReturn"),t=require("../../@babel/runtime/helpers/getPrototypeOf"),r=require("../../@babel/runtime/helpers/inherits"),i=require("../../@babel/runtime/helpers/createClass"),n=require("../../@babel/runtime/helpers/classCallCheck");var l=require("../../utils/utils"),s=require("./calc-angle").CalcAngle,c=i((function e(){n(this,e),this.name="垂直计算",this.calc="vertical",this.upperKey=null,this.centerKey=null,this.lowerKey=null,this.offset=15})),u=function(c){function u(r,i){var s,c,o,a;return n(this,u),l.isNone(r)||(s.threshold=r),c=this,a=[i],o=t(o=u),(s=e(c,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(o,a||[],t(c).constructor):o.apply(c,a))).threshold=15,s}return r(u,s),i(u,[{key:"isVertical",value:function(e,t,r,i,n){if(l.isNone(n)&&(n=this.threshold),!r){r="ref_center";var s=this.findPoint(e,t),c=this.findPoint(e,i);if(!s||!c)return!1;(e=l.clone(e)).push({y:Math.abs(s.y-c.y)/2+Math.min(s.y,c.y),x:Math.abs(s.x-c.x)/2+Math.min(s.x,c.x),score:1,name:r})}if(!this.matchAngle(e,r,t,i,180,n))return!1;var u=this.findPoint(e,r),o=this.findPoint(e,t),a=this.findPoint(e,i),h=l.clone(u);h.x=0;var f=this.angle(u,h,o);return!!this.isAngle(f,90,n)&&(f=this.angle(u,h,a),!!this.isAngle(f,90,n))}},{key:"judging",value:function(e,t){if(!t||"vertical"!=t.calc)throw new Error("规则为空，或者配置的不是垂直规则");try{if(!t.upperKey||!t.lowerKey)throw new Error("upperKey、lowerKey不能为空");return this.isVertical(e.keypoints,t.upperKey,t.centerKey,t.lowerKey,t.offset)}catch(e){return console.warn("calc-vertical",e),!1}}}])}();module.exports={CalcRuleVertical:c,CalcVertical:u};