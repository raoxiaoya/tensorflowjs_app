var e=require("../../@babel/runtime/helpers/possibleConstructorReturn"),r=require("../../@babel/runtime/helpers/getPrototypeOf"),t=require("../../@babel/runtime/helpers/inherits"),n=require("../../@babel/runtime/helpers/createClass"),i=require("../../@babel/runtime/helpers/classCallCheck");var o=require("../../utils/utils"),c=require("./calc-base"),a=n((function e(){i(this,e),this.name="人体全身识别成功检测",this.calc="whole",this.range={top:0,left:0,width:480,heigth:680},this.relaxed=!1})),l=function(a){function l(t){var n,c,a,u;if(i(this,l),o.isNone(t))throw new Error("calculator不能为空。");return c=this,a=r(a=l),(n=e(c,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(a,u||[],r(c).constructor):a.apply(c,u)))._calculator=null,n._calculator=t,n}return t(l,c),n(l,[{key:"pointScoreChecking",value:function(e){if(!e||o.isEmptyArray(e.keypoints))return!1;var r=this._calculator.buildCalcer("camera-view").isViewName(e),t=this;switch(r){case"left":return e.keypoints.every((function(e){return!e.name.startsWith("left_")||e.score>=t.pointThreshold}));case"right":return e.keypoints.every((function(e){return!e.name.startsWith("right_")||e.score>=t.pointThreshold}));case"front":case"back":default:return e.keypoints.every((function(e){return e.score>=t.pointThreshold}))}}},{key:"judging",value:function(e,r){if(!r||"whole"!=r.calc)throw new Error("规则为空，或者配置的不是范围内全身检查规则");if(!r.relaxed&&!this.pointScoreChecking(e))return!1;try{var t=0,n=e.width,i=0,c=e.heigth;r.range&&(t=r.range.left,n=r.range.left+r.range.width,i=r.range.top,c=r.range.top+r.range.heigth);var a=e.keypoints;return!o.isEmptyArray(a)&&!a.some((function(e){return e.x<t||e.x>n||e.y<i||e.y>c}))}catch(e){return console.warn("calc-whole",e),!1}}}])}();module.exports={CalcRuleWhold:a,CalcWhole:l};