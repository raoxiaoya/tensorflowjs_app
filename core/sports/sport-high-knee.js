var e=require("../../@babel/runtime/helpers/classCallCheck"),t=require("../../@babel/runtime/helpers/createClass"),r=require("../../@babel/runtime/helpers/possibleConstructorReturn"),i=require("../../@babel/runtime/helpers/get"),l=require("../../@babel/runtime/helpers/getPrototypeOf"),s=require("../../@babel/runtime/helpers/inherits");var n=require("../../utils/utils"),a=require("../saber"),o=require("./sport-base"),c=require("../body-calc/calculator"),u=require("../body-calc/calc-base"),h=function(h){function f(t){var i,s,n,a;return e(this,f),s=this,a=[t],n=l(n=f),(i=r(s,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(n,a||[],l(s).constructor):n.apply(s,a)))._calculator=null,i.rules=null,i.stateTran=-1,i.view="front",i.tickMode=!0,i._calcBase=new u,i._calculator=new c,i._calculator.pointThreshold=i.pointThreshold,i.rules={highLow:.1},i.buildRules(),i}return s(f,o),t(f,[{key:"start",value:function(){i(l(f.prototype),"start",this).call(this),this._calculator.pointThreshold=this.pointThreshold}},{key:"buildRules",value:function(){this.rules.basePose={name:"人体基本姿态",calc:"$and",rules:[{name:"正面视图",calc:"camera-view",position:"front"},{name:"全身需入镜",calc:"whole",relaxed:!0}]},this.rules.leftPose={name:"左抬腿时，右臂要求",calc:"$and",rules:[{name:"右-腋下夹角",calc:"match-angle",angleKey:"right_shoulder",secondKey:"right_elbow",thirdKey:"right_hip",angle:40,offset:35},{name:"右-手臂弯曲夹角",calc:"match-angle",angleKey:"right_elbow",secondKey:"right_shoulder",thirdKey:"right_wrist",angle:55,offset:35}]},this.rules.rightPose={name:"右抬腿时，左臂要求",calc:"$and",rules:[{name:"左-腋下夹角",calc:"match-angle",angleKey:"left_shoulder",secondKey:"left_elbow",thirdKey:"left_hip",angle:40,offset:35},{name:"右-手臂弯曲夹角",calc:"match-angle",angleKey:"left_elbow",secondKey:"left_shoulder",thirdKey:"left_wrist",angle:55,offset:35}]}}},{key:"pushing",value:function(e){if(this.isCounting&&!n.isNone(e)&&this._calculator.calculating(e,this.rules.basePose)){var t=0;if(this.rules.highLow&&(t=e.getBodyRange().height*this.rules.highLow),1!=this.stateTran){var r=this._calcBase.findPoint(e.keypoints,"left_ankle"),i=this._calcBase.findPoint(e.keypoints,"right_knee");return r&&i?r.y>i.y+t?void a.writeConsoleDebug("左腿未抬高到位。"):(this.stateTran=1,this.countTimes(),this.emitTick(),void a.writeConsoleDebug("左")):void a.writeConsoleDebug("未检测左抬腿脚部关键点。")}if(2!=this.stateTran){var l=this._calcBase.findPoint(e.keypoints,"right_ankle"),s=this._calcBase.findPoint(e.keypoints,"left_knee");return l&&s?l.y>s.y+t?void a.writeConsoleDebug("右腿未抬高到位。"):(this.stateTran=2,this.countTimes(),this.emitTick(),void a.writeConsoleDebug("右")):void a.writeConsoleDebug("未检测右抬腿脚部关键点。")}a.writeConsoleDebug("动作不符合要求")}}}])}();h.KEY="High-Knee",h.NAME="高抬腿",module.exports=h;